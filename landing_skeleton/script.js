/*
 * =================================================================================================
 * 테마 토글 기능 (필수)
 * =================================================================================================
 */
document.addEventListener('DOMContentLoaded', () => {
    const themeToggleButton = document.querySelector('.theme-toggle-button');
    const themeLogo = document.getElementById('theme-logo');

    // SVG 아이콘 정의
    const sunIcon = `<svg class="theme-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M8 3.86361C7.83258 3.86361 7.69223 3.80698 7.57898 3.69372C7.46572 3.58046 7.40909 3.44012 7.40909 3.2727V2.09088C7.40909 1.92345 7.46572 1.78311 7.57898 1.66986C7.69223 1.5566 7.83258 1.49997 8 1.49997C8.16742 1.49997 8.30777 1.5566 8.42102 1.66986C8.53428 1.78311 8.59091 1.92345 8.59091 2.09088V3.2727C8.59091 3.44012 8.53428 3.58046 8.42102 3.69372C8.30777 3.80698 8.16742 3.86361 8 3.86361ZM10.925 5.07497C10.8167 4.96664 10.7625 4.83122 10.7625 4.66872C10.7625 4.50622 10.8167 4.36588 10.925 4.2477L11.7523 3.40565C11.8705 3.28747 12.0108 3.22838 12.1733 3.22838C12.3358 3.22838 12.4761 3.28747 12.5943 3.40565C12.7027 3.51398 12.7568 3.65186 12.7568 3.81929C12.7568 3.98671 12.7027 4.12459 12.5943 4.23292L11.7523 5.07497C11.6439 5.1833 11.5061 5.23747 11.3386 5.23747C11.1712 5.23747 11.0333 5.1833 10.925 5.07497ZM12.7273 8.59088C12.5598 8.59088 12.4195 8.53425 12.3062 8.42099C12.193 8.30773 12.1364 8.16739 12.1364 7.99997C12.1364 7.83255 12.193 7.6922 12.3062 7.57895C12.4195 7.46569 12.5598 7.40906 12.7273 7.40906H13.9091C14.0765 7.40906 14.2169 7.46569 14.3301 7.57895C14.4434 7.6922 14.5 7.83255 14.5 7.99997C14.5 8.16739 14.4434 8.30773 14.3301 8.42099C14.2169 8.53425 14.0765 8.59088 13.9091 8.59088H12.7273ZM8 14.5C7.83258 14.5 7.69223 14.4433 7.57898 14.3301C7.46572 14.2168 7.40909 14.0765 7.40909 13.9091V12.7272C7.40909 12.5598 7.46572 12.4195 7.57898 12.3062C7.69223 12.193 7.83258 12.1363 8 12.1363C8.16742 12.1363 8.30777 12.193 8.42102 12.3062C8.53428 12.4195 8.59091 12.5598 8.59091 12.7272V13.9091C8.59091 14.0765 8.53428 14.2168 8.42102 14.3301C8.30777 14.4433 8.16742 14.5 8 14.5ZM4.24773 5.07497L3.40568 4.2477C3.2875 4.12951 3.22841 3.98671 3.22841 3.81929C3.22841 3.65186 3.2875 3.51398 3.40568 3.40565C3.51402 3.29732 3.65189 3.24315 3.81932 3.24315C3.98674 3.24315 4.12462 3.29732 4.23295 3.40565L5.075 4.2477C5.18333 4.35603 5.2375 4.49391 5.2375 4.66133C5.2375 4.82876 5.18333 4.96664 5.075 5.07497C4.95682 5.1833 4.81894 5.23747 4.66136 5.23747C4.50379 5.23747 4.36591 5.1833 4.24773 5.07497ZM11.7523 12.5943L10.925 11.7522C10.8167 11.6341 10.7625 11.4937 10.7625 11.3312C10.7625 11.1687 10.8167 11.0333 10.925 10.925C11.0333 10.8166 11.1687 10.7625 11.3312 10.7625C11.4937 10.7625 11.6341 10.8166 11.7523 10.925L12.5943 11.7522C12.7125 11.8606 12.7691 11.9985 12.7642 12.1659C12.7593 12.3333 12.7027 12.4761 12.5943 12.5943C12.4761 12.7125 12.3333 12.7716 12.1659 12.7716C11.9985 12.7716 11.8606 12.7125 11.7523 12.5943ZM2.09091 8.59088C1.92348 8.59088 1.78314 8.53425 1.66989 8.42099C1.55663 8.30773 1.5 8.16739 1.5 7.99997C1.5 7.83255 1.55663 7.6922 1.66989 7.57895C1.78314 7.46569 1.92348 7.40906 2.09091 7.40906H3.27273C3.44015 7.40906 3.58049 7.46569 3.69375 7.57895C3.80701 7.6922 3.86364 7.83255 3.86364 7.99997C3.86364 8.16739 3.80701 8.30773 3.69375 8.42099C3.58049 8.53425 3.44015 8.59088 3.27273 8.59088H2.09091ZM3.40568 12.5943C3.29735 12.486 3.24318 12.3481 3.24318 12.1807C3.24318 12.0132 3.29735 11.8753 3.40568 11.767L4.24773 10.925C4.35606 10.8166 4.49148 10.7625 4.65398 10.7625C4.81648 10.7625 4.95682 10.8166 5.075 10.925C5.19318 11.0432 5.25227 11.1835 5.25227 11.346C5.25227 11.5085 5.19318 11.6488 5.075 11.767L4.24773 12.5943C4.12955 12.7125 3.98674 12.7716 3.81932 12.7716C3.65189 12.7716 3.51402 12.7125 3.40568 12.5943ZM8 11.5454C7.01515 11.5454 6.17803 11.2007 5.48864 10.5113C4.79924 9.82194 4.45455 8.98482 4.45455 7.99997C4.45455 7.01512 4.79924 6.178 5.48864 5.48861C6.17803 4.79921 7.01515 4.45451 8 4.45451C8.98485 4.45451 9.82197 4.79921 10.5114 5.48861C11.2008 6.178 11.5455 7.01512 11.5455 7.99997C11.5455 8.98482 11.2008 9.82194 10.5114 10.5113C9.82197 11.2007 8.98485 11.5454 8 11.5454ZM8 10.3636C8.65 10.3636 9.20644 10.1322 9.66932 9.66929C10.1322 9.20641 10.3636 8.64997 10.3636 7.99997C10.3636 7.34997 10.1322 6.79353 9.66932 6.33065C9.20644 5.86777 8.65 5.63633 8 5.63633C7.35 5.63633 6.79356 5.86777 6.33068 6.33065C5.8678 6.79353 5.63636 7.34997 5.63636 7.99997C5.63636 8.64997 5.8678 9.20641 6.33068 9.66929C6.79356 10.1322 7.35 10.3636 8 10.3636Z" fill="currentColor"/></svg>`;
    const moonIcon = `<svg class="theme-icon" width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M8 14C6.32222 14 4.90278 13.4194 3.74167 12.2583C2.58056 11.0972 2 9.67778 2 8C2 6.46667 2.5 5.13611 3.5 4.00833C4.5 2.88056 5.77778 2.22222 7.33333 2.03333C7.47778 2.01111 7.60556 2.03056 7.71667 2.09167C7.82778 2.15278 7.91667 2.23333 7.98333 2.33333C8.05 2.43333 8.08611 2.55 8.09167 2.68333C8.09722 2.81667 8.05556 2.94444 7.96667 3.06667C7.77778 3.35556 7.63611 3.66111 7.54167 3.98333C7.44722 4.30556 7.4 4.64444 7.4 5C7.4 6 7.75 6.85 8.45 7.55C9.15 8.25 10 8.6 11 8.6C11.3444 8.6 11.6861 8.55 12.025 8.45C12.3639 8.35 12.6667 8.21111 12.9333 8.03333C13.0556 7.95556 13.1806 7.91944 13.3083 7.925C13.4361 7.93056 13.55 7.96111 13.65 8.01667C13.7611 8.07222 13.8472 8.15556 13.9083 8.26667C13.9694 8.37778 13.9889 8.51111 13.9667 8.66667C13.8111 10.2 13.1583 11.4722 12.0083 12.4833C10.8583 13.4944 9.52222 14 8 14ZM8 12.6667C8.97778 12.6667 9.85556 12.3972 10.6333 11.8583C11.4111 11.3194 11.9778 10.6167 12.3333 9.75C12.1111 9.80556 11.8889 9.85 11.6667 9.88333C11.4444 9.91667 11.2222 9.93333 11 9.93333C9.63333 9.93333 8.46944 9.45278 7.50833 8.49167C6.54722 7.53056 6.06667 6.36667 6.06667 5C6.06667 4.77778 6.08333 4.55556 6.11667 4.33333C6.15 4.11111 6.19444 3.88889 6.25 3.66667C5.38333 4.02222 4.68056 4.58889 4.14167 5.36667C3.60278 6.14444 3.33333 7.02222 3.33333 8C3.33333 9.28889 3.78889 10.3889 4.7 11.3C5.61111 12.2111 6.71111 12.6667 8 12.6667Z" fill="currentColor"/></svg>`;

    let isDarkTheme = localStorage.getItem('isDarkTheme') === 'true';

    function setTheme(isDark) {
        isDarkTheme = isDark;
        localStorage.setItem('isDarkTheme', isDark);

        const foundationLink = document.getElementById('vapor-foundation');
        const foundationPreloadDark = document.getElementById('vapor-foundation-preload-dark');
        const foundationPreloadLight = document.getElementById('vapor-foundation-preload-light');

        if (isDark) {
            foundationLink.href = foundationPreloadDark.href;
            document.documentElement.setAttribute('data-theme', 'dark');
            if (themeLogo) themeLogo.src = 'https://statics.goorm.io/logo/goorm.svg';
            themeToggleButton.innerHTML = sunIcon;
        } else {
            foundationLink.href = foundationPreloadLight.href;
            document.documentElement.setAttribute('data-theme', 'light');
            if (themeLogo) themeLogo.src = 'https://statics.goorm.io/logo/goorm.svg';
            themeToggleButton.innerHTML = moonIcon;
        }
    }

    function toggleTheme() {
        setTheme(!isDarkTheme);
    }

    setTheme(isDarkTheme);

    themeToggleButton.addEventListener('click', (e) => {
        e.preventDefault();
        toggleTheme();
    });
});

/*
 * =================================================================================================
 * TOP 버튼 (필수)
 * =================================================================================================
 */
document.addEventListener('DOMContentLoaded', () => {
    const topButton = document.getElementById('top-button');
    if (topButton) {
        topButton.addEventListener('click', (e) => {
            e.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    }
});

/*
 * =================================================================================================
 * 네비게이션 스크롤 시 border-bottom 표시 (추가)
 * =================================================================================================
 */
document.addEventListener('DOMContentLoaded', () => {
    const navbar = document.querySelector('.navbar');
    function handleNavbarBorder() {
        if (window.scrollY > 0) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    }
    window.addEventListener('scroll', handleNavbarBorder);
    handleNavbarBorder(); // 페이지 진입 시 바로 적용
});